(this.webpackJsonprotoshop=this.webpackJsonprotoshop||[]).push([[0],{329:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={BRIGHTNESS:"brightness",SATURATION:"saturation",CONTRAST:"contrast"}},357:function(e,t,n){"use strict";n.r(t);var r=n(34),a=n(17),i=n.n(a),o=n(27),c=n(39),s=n(0),u=n.n(s),f=n(319),l=Object(f.a)(((e,t,n=!0)=>(...r)=>(n&&console.log(e,...r),t(...r)))("canvas-editor",e=>({canvas:{height:"calc(100% - 60px)",width:"calc(100% - 60px)",margin:"30px 0",background:"#fafafa",boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 2px 1px -1px rgba(0,0,0,0.12)"}}),!1));var h=function({canvas:e={},image:t,brightness:n=100}){var r=l(),a=Object(s.useRef)(null);Object(s.useEffect)(()=>{var e,r=a.current,i=r.getContext("2d");(e=t,new Promise(t=>{var n=new Image;n.onload=()=>t(n),n.src=e})).then(e=>{i.filter="sepia(.15) contrast(1.25) brightness(".concat(n,"%) hue-rotate(5deg)"),i.drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height)})},[t,a,n]);var i=Object.assign({},{id:"editor",className:r.canvas,ref:a},e);return u.a.createElement("canvas",i)},m=n(96),d=n(89),g=n.n(d);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var v="undefined"!=typeof window&&window.cordova&&window.cordova.require("cordova/modulemapper"),w=v&&v.getOriginalSymbol(window,"File")||File,b=v&&v.getOriginalSymbol(window,"FileReader")||FileReader;function x(e){return new Promise((function(t,n){var r=new b;r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)},r.readAsDataURL(e)}))}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();return new Promise((function(r){for(var a=e.split(","),i=a[0].match(/:(.*?);/)[1],o=atob(a[1]),c=o.length,s=new Uint8Array(c);c--;)s[c]=o.charCodeAt(c);var u=new Blob([s],{type:i});u.name=t,u.lastModified=n,r(u)}))}function O(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){return t(r)},r.onerror=function(e){return n(e)},r.src=e}))}function C(e){var t=p(j(e.width,e.height),2),n=t[0];return t[1].drawImage(e,0,0,n.width,n.height),n}function I(e){return new Promise((function(t,n){var r,a,i=function(){try{return a=C(r),t([r,a])}catch(e){return n(e)}},o=function(t){try{return x(e).then((function(e){try{return O(e).then((function(e){try{return r=e,i()}catch(e){return n(e)}}),n)}catch(e){return n(e)}}),n)}catch(e){return n(e)}};try{return createImageBitmap(e).then((function(e){try{return r=e,i()}catch(e){return o()}}),o)}catch(e){o()}}))}function F(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return new Promise((function(i,o){var c;return"function"==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?e.convertToBlob({type:t,quality:a}).then(function(e){try{return(c=e).name=n,c.lastModified=r,s.call(this)}catch(e){return o(e)}}.bind(this),o):y(e.toDataURL(t,a),n,r).then(function(e){try{return c=e,s.call(this)}catch(e){return o(e)}}.bind(this),o);function s(){return i(c)}}))}function k(e){return new Promise((function(t,n){var r=new b;r.onload=function(e){var n=new DataView(e.target.result);if(65496!=n.getUint16(0,!1))return t(-2);for(var r=n.byteLength,a=2;a<r;){if(n.getUint16(a+2,!1)<=8)return t(-1);var i=n.getUint16(a,!1);if(a+=2,65505==i){if(1165519206!=n.getUint32(a+=2,!1))return t(-1);var o=18761==n.getUint16(a+=6,!1);a+=n.getUint32(a+4,o);var c=n.getUint16(a,o);a+=2;for(var s=0;s<c;s++)if(274==n.getUint16(a+12*s,o))return t(n.getUint16(a+12*s+8,o))}else{if(65280!=(65280&i))break;a+=n.getUint16(a,!1)}}return t(-1)},r.onerror=function(e){return n(e)},r.readAsArrayBuffer(e)}))}function U(e,t){var n,r=e.width,a=e.height,i=t.maxWidthOrHeight,o=e;if(Number.isInteger(i)&&(r>i||a>i)){var c=p(j(r,a),2);o=c[0],n=c[1],r>a?(o.width=i,o.height=a/r*i):(o.width=r/a*i,o.height=i),n.drawImage(e,0,0,o.width,o.height)}return o}function E(e,t){var n=e.width,r=e.height,a=p(j(n,r),2),i=a[0],o=a[1];switch(4<t&&t<9?(i.width=r,i.height=n):(i.width=n,i.height=r),t){case 2:o.transform(-1,0,0,1,n,0);break;case 3:o.transform(-1,0,0,-1,n,r);break;case 4:o.transform(1,0,0,-1,0,r);break;case 5:o.transform(0,1,1,0,0,0);break;case 6:o.transform(0,1,-1,0,r,0);break;case 7:o.transform(0,-1,-1,0,r,n);break;case 8:o.transform(0,-1,1,0,0,n)}return o.drawImage(e,0,0,n,r),i}function j(e,t){var n,r;try{r=(n=new OffscreenCanvas(e,t)).getContext("2d")}catch(e){r=(n=document.createElement("canvas")).getContext("2d")}return n.width=e,n.height=t,[n,r]}function T(e,t){return new Promise((function(n,r){var a,i,o,c,s,u;return a=t.maxIteration||10,i=1024*t.maxSizeMB*1024,I(e).then(function(f){try{var l=p(f,2);return l[0],o=U(o=l[1],t),new Promise((function(n,r){var a;if(!(a=t.exifOrientation))return k(e).then(function(e){try{return a=e,i.call(this)}catch(e){return r(e)}}.bind(this),r);function i(){return n(a)}return i.call(this)})).then(function(f){try{return t.exifOrientation=f,o=E(o,t.exifOrientation),c=1,F(o,e.type,e.name,e.lastModified,c).then(function(t){try{var f,l=function t(){if(a--&&u.size>i){var n,s,f,l=p(j(n=.9*o.width,s=.9*o.height),2);return f=l[0],l[1].drawImage(o,0,0,n,s),"image/jpeg"===e.type&&(c*=.9),F(f,e.type,e.name,e.lastModified,c).then((function(e){try{return u=e,o=f,t}catch(e){return r(e)}}),r)}return[1]},h=function(){return n(u)};return(s=t).size<=i?n(s):(u=s,(f=function(e){for(;e;){if(e.then)return void e.then(f,r);try{if(e.pop){if(e.length)return e.pop()?h.call(this):e;e=l}else e=e.call(this)}catch(e){return r(e)}}}.bind(this))(l))}catch(e){return r(e)}}.bind(this),r)}catch(e){return r(e)}}.bind(this),r)}catch(e){return r(e)}}.bind(this),r)}))}var W,D=0,S=function(e){return new Worker(URL.createObjectURL(new Blob(["(".concat(e,")()")])))}((function(){var e=!1;self.addEventListener("message",(function(t){return new Promise((function(n,r){var a,i,o,c,s=t.data;a=s.file,i=s.id,o=s.imageCompressionLibUrl,c=s.options;var u=function(){try{return n()}catch(e){return r(e)}},f=function(e){try{return self.postMessage({error:e.message+"\n"+e.stack,id:i}),u()}catch(e){return r(e)}};try{var l;return e||(importScripts(o),e=!0),R(a,c).then((function(e){try{return l=e,self.postMessage({file:l,id:i}),u()}catch(e){return f(e)}}),f)}catch(e){f(e)}}))}))}));function M(e,t){return new Promise((function(n,r){return new Promise((function(a,i){W||(W=function(e){return URL.createObjectURL(new Blob([e],{type:"application/javascript"}))}("\n    function imageCompression (){return (".concat(R,").apply(null, arguments)}\n\n    imageCompression.getDataUrlFromFile = ").concat(R.getDataUrlFromFile,"\n    imageCompression.getFilefromDataUrl = ").concat(R.getFilefromDataUrl,"\n    imageCompression.loadImage = ").concat(R.loadImage,"\n    imageCompression.drawImageInCanvas = ").concat(R.drawImageInCanvas,"\n    imageCompression.drawFileInCanvas = ").concat(R.drawFileInCanvas,"\n    imageCompression.canvasToFile = ").concat(R.canvasToFile,"\n    imageCompression.getExifOrientation = ").concat(R.getExifOrientation,"\n    imageCompression.handleMaxWidthOrHeight = ").concat(R.handleMaxWidthOrHeight,"\n    imageCompression.followExifOrientation = ").concat(R.followExifOrientation,"\n\n    getDataUrlFromFile = imageCompression.getDataUrlFromFile\n    getFilefromDataUrl = imageCompression.getFilefromDataUrl\n    loadImage = imageCompression.loadImage\n    drawImageInCanvas = imageCompression.drawImageInCanvas\n    drawFileInCanvas = imageCompression.drawFileInCanvas\n    canvasToFile = imageCompression.canvasToFile\n    getExifOrientation = imageCompression.getExifOrientation\n    handleMaxWidthOrHeight = imageCompression.handleMaxWidthOrHeight\n    followExifOrientation = imageCompression.followExifOrientation\n\n    getNewCanvasAndCtx = ").concat(j,"\n    \n    CustomFileReader = FileReader\n    \n    CustomFile = File\n    \n    function _slicedToArray(arr, n) { return arr }\n\n    function compress (){return (").concat(T,").apply(null, arguments)}\n    ")));var o=D++;return S.addEventListener("message",(function e(t){t.data.id===o&&(S.removeEventListener("message",e),t.data.error&&r(new Error(t.data.error)),n(t.data.file))})),S.postMessage({file:e,id:o,imageCompressionLibUrl:W,options:t}),a()}))}))}function R(e,t){return new Promise((function(n,r){var a,i;if(t.maxSizeMB=t.maxSizeMB||Number.POSITIVE_INFINITY,t.useWebWorker="boolean"!=typeof t.useWebWorker||t.useWebWorker,!(e instanceof Blob||e instanceof w))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(e.type))return r(new Error("The file given is not an image"));if(i="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,!t.useWebWorker||"function"!=typeof Worker||i)return T(e,t).then(function(e){try{return a=e,s.call(this)}catch(e){return r(e)}}.bind(this),r);var o=function(){try{return s.call(this)}catch(e){return r(e)}}.bind(this),c=function(n){try{return console.warn("Run compression in web worker failed:",n,", fall back to main thread"),T(e,t).then((function(e){try{return a=e,o()}catch(e){return r(e)}}),r)}catch(e){return r(e)}};try{return M(e,t).then((function(e){try{return a=e,o()}catch(e){return c(e)}}),c)}catch(e){c(e)}function s(){try{a.name=e.name,a.lastModified=e.lastModified}catch(e){}return n(a)}}))}R.getDataUrlFromFile=x,R.getFilefromDataUrl=y,R.loadImage=O,R.drawImageInCanvas=C,R.drawFileInCanvas=I,R.canvasToFile=F,R.getExifOrientation=k,R.handleMaxWidthOrHeight=U,R.followExifOrientation=E;var A=R,B=n(93),P=e=>new g.a((t,n)=>{var r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>n(e)}),L=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},e.next=3,A(t,n);case 3:return r=e.sent,e.next=6,P(r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.dataTransfer.items){e.next=9;break}if(n=Object(c.a)(t.dataTransfer.items,1),"file"!==(r=n[0]).kind){e.next=7;break}return a=r.getAsFile(),e.next=6,L(a);case 6:return e.abrupt("return",e.sent);case 7:e.next=13;break;case 9:return o=Object(c.a)(t.dataTransfer.files,1),s=o[0],e.next=12,L(s);case 12:return e.abrupt("return",e.sent);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.set("image",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=n(329),G=Object(f.a)(e=>({container:{height:"calc(100% - 112px)",width:"100%"}}));t.default=function(e,t){var n=G(),a=Object(s.useState)(100),f=Object(c.a)(a,2),l=f[0],d=f[1],g=Object(s.useContext)(m.a).setImage;Object(s.useEffect)(()=>{function e(){return(e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,B.a.get(z.a.BRIGHTNESS);case 3:if(e.t1=e.sent,e.t1){e.next=6;break}e.t1=100;case 6:e.t2=e.t1,(0,e.t0)(e.t2);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),()=>{}},[]);var p={canvas:{onDrop:e=>{function t(){return(t=Object(o.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(e);case 2:return n=t.sent,g(n),t.next=6,H(n);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.preventDefault(),function(){t.apply(this,arguments)}()},onDragOver:e=>e.preventDefault()},brightness:l};return u.a.createElement("div",{className:n.container},u.a.createElement(m.a.Consumer,null,({image:e})=>u.a.createElement(h,Object(r.a)(Object(r.a)({},p),{},{image:e}))))}}}]);
//# sourceMappingURL=canvas.dc3dea94.chunk.js.map